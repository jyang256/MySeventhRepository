# Front-end Asynchronous Data (Thursday)

Work together, within your team, on building out this code.

## Setup
Make sure you have one command prompt open and running `npm run server:root`. (Why?)

Make sure you **ARE NOT** running the JSON server. 

All work will be done in `rest-project/server`.

Don't forget to do your work on a branch! And a branch that includes working client code.

## Part 1 - Set up Express

First, we will get Express up and running.

Open `app.js`. A lot of the work in app.js has been done for you. In reality, this code would either be generated by the express generator (look it up on npmjs.org), or not used in production (the lowdb stuff which we will eventually replace with database calls).  

Look for the sections marked `// TODO: Part 1...`  

Add two routes to `app`. Both should answer HTTP GET requests only. 
The first should answer on the path '/' and should serve up `views/home.html`.  
The second should answer any other GET request, regardless of path, and 
should log that a bad route was requested and return a 404. 

Does ordering matter here? 

Run the server by opening a terminal:  
Change directory to `rest-project/server`  
Run the server via `npx nodemon app.js`. *What does this do?*
Using the browser, you can navigate to http://localhost:8001/ to see if the home page for the application (in HTML) comes up. 

## Part 2: Setting up an API

We are going to build routers to set up an API. At first, we will only have a minimal implementation. In the next part, we will complete the implementation. 

### routes/student-routes.js

In the TODO marked "Part 2", set up a minimal route for '/students'. It should answer GET requests on the path '/students'. It should respond with a simple message of "You requested the students resource". We will update this in the next part.

### routes/api-routes.js

In the first TODO, use the `require` method to require `student-routes.js`. Assign it to `studentsRouter`.

In the second TODO, have the router use `studentsRouter`. Don't forget that `studentsRouter` is a function and it should be passed the `db`. 

### app.js

In the first TODO, use the `require` method to require `api-routes.js`. Assign it to `apiRouter`.

In the second TODO, have the app use `apiRouter`. It should answer on a properly versioned path. Don't forget that `apiRouter` is a function and it should be passed the `db`. 

Assuming you left the server runing with `nodemon`, navigate to http://localhost:8001/[your api router and version]/students with either Chrome or Postman to see if it returns the right values.

## Part 3 - Completing the implementation

All your work will be in `routes/student-routes`. Note that there are several functions at the top of the file which take care of data fetching and modification. This exercise isn't about the use of lowdb (though it's a useful tool!). It's about RESTful implementations, so we have isolated lowdb ops into their own functions.

Implement the following routes:

| Path          | HTTP   | Function          | Returns                              |
|---------------|--------|-------------------|--------------------------------------|
| /students     | GET    | findAllStudents() | array of students, possibly filtered |
| /students     | POST   | addStudent()      | added student (with ID)              |
| /students/:id | GET    | findStudent()     | student if found, 404 otherwise      |
| /students/:id | PATCH  | updateStudent()   | Updated student                      |
| /students/:id | DELETE | deleteStudent()   | Status 204                           |

Implement a route, then test it. Then implement another. Use Chrome, Postman, or both.  

### Common issues

- Ids will come from req.params or req.query. In both cases, they will be **STRINGS**. But ids in the JSON file are **NUMBERS**. That will be an issue.

- Quick reminders
  - `req.body`: Available on POST, PUT, PATCH, the JSON-parsed version of the data passed to this route
  - `req.query`: Query string data, e.g. 
  https://localhost:8001/students?**lastName=Paxton**
  - `req.params`: The parameters identified on the URL (e.g. /students/**:id**)